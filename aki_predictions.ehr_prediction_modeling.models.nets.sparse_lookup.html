
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup module &#8212; aki-predictions 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="aki_predictions.ehr_prediction_modeling.models.cell_factory module" href="aki_predictions.ehr_prediction_modeling.models.cell_factory.html" />
    <link rel="prev" title="aki_predictions.ehr_prediction_modeling.models.nets.snr module" href="aki_predictions.ehr_prediction_modeling.models.nets.snr.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup">
<span id="aki-predictions-ehr-prediction-modeling-models-nets-sparse-lookup-module"></span><h1>aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup module<a class="headerlink" href="#module-aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup" title="Permalink to this heading">¶</a></h1>
<p>Sparse Lookup Encoder, for use as a basic lookup embedding or by other encoders.</p>
<dl class="py class">
<dt class="sig sig-object py" id="aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup.SparseLookupEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup.</span></span><span class="sig-name descname"><span class="pre">SparseLookupEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ndim_emb:</span> <span class="pre">int,</span> <span class="pre">ndim_input:</span> <span class="pre">int,</span> <span class="pre">n_act:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">activate_final:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">act_fn:</span> <span class="pre">~typing.Callable[[~tensorflow.python.framework.ops.Tensor],</span> <span class="pre">~tensorflow.python.framework.ops.Tensor]</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">tanh&gt;,</span> <span class="pre">sparse_lookup_dropout_prob:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">dropout_is_training:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">sparse_combine:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'sum',</span> <span class="pre">name:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">identity_lookup:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup.SparseLookupEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractModule</span></code></p>
<p>A lookup embedding based on lookup table to be used by other classes.</p>
<p>Initialise SparseLookupEncoder.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup.combiner_correction">
<span class="sig-prename descclassname"><span class="pre">aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup.</span></span><span class="sig-name descname"><span class="pre">combiner_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sparse_combiner</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup.combiner_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Corrections for fixing NaNs in certain combining methods.</p>
<p>There are many zero-only rows, which result in NaN/inf entries when using a
sparse_combine method other than “sum”, because it divides by zero.
Here, this checks for NaNs and replaces them with zeros.
Must be careful here that any NaNs that enter before this point are not
hidden.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sparse_combiner</strong> – The embedding reduction method.</p></li>
<li><p><strong>embed</strong> – The embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The embedding without NaN values (they are replaced with zeros).</p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">aki-predictions</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">NHS AI Lab Skunkworks project: Predictive Renal Health</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="aki_predictions.html">aki_predictions package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="aki_predictions.html#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="aki_predictions.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">aki_predictions</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="aki_predictions.html">aki_predictions package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="aki_predictions.html">aki_predictions package</a><ul>
  <li><a href="aki_predictions.ehr_prediction_modeling.html">aki_predictions.ehr_prediction_modeling package</a><ul>
  <li><a href="aki_predictions.ehr_prediction_modeling.models.html">aki_predictions.ehr_prediction_modeling.models package</a><ul>
  <li><a href="aki_predictions.ehr_prediction_modeling.models.nets.html">aki_predictions.ehr_prediction_modeling.models.nets package</a><ul>
      <li>Previous: <a href="aki_predictions.ehr_prediction_modeling.models.nets.snr.html" title="previous chapter">aki_predictions.ehr_prediction_modeling.models.nets.snr module</a></li>
      <li>Next: <a href="aki_predictions.ehr_prediction_modeling.models.cell_factory.html" title="next chapter">aki_predictions.ehr_prediction_modeling.models.cell_factory module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;Crown copyright.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/aki_predictions.ehr_prediction_modeling.models.nets.sparse_lookup.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>